# Руководство по эмуляции поведения дашборда Visiology

## Описание проблемы

При масштабировании дашборда Visiology использует CSS `transform: scale()` для элемента `.va-dashboard-container`. Это создает проблему с всплывающими элементами DevExtreme (filterRow, headerFilter, popup и др.), потому что:

1. DevExtreme использует `getBoundingClientRect()` для позиционирования всплывающих элементов
2. `getBoundingClientRect()` возвращает координаты в viewport, но не учитывает CSS transform родительских элементов
3. При масштабе отличном от 100%, всплывающие элементы отображаются в неправильных позициях

## Архитектура масштабирования Visiology

Дашборд Visiology работает следующим образом:

1. **Фиксированное разрешение листа**: 1920x1080px (или другое заданное)
2. **Масштабирование**: Применяется CSS transform через переменные
   ```css
   .va-dashboard-container {
     --zoom-scale: 1;
     transform: scale(var(--zoom-scale));
     transform-origin: left top;
   }
   ```
3. **Режимы отображения**:

   - `FitInPage` - масштабирование как object-fit: contain (весь лист виден)
   - `FitInWidth` - масштабирование по ширине
   - `ActualSize` - без масштабирования (100%)

4. **data-scale-value атрибут**: Хранит текущий масштаб для использования в пропатченном DevExtreme


## Обязательные CSS

```css
.va-dashboard-container {
  transform-origin: left top;
  --translate-x: 0;
  --translate-y: 0;
  --zoom-scale: 1;
  transform: translate(var(--translate-x), var(--translate-y)) scale(
      var(--zoom-scale)
    );
}
```
